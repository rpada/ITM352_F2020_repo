
<script src="./product_data.js" type="text/javascript"></script>
 <script src="main.js"></script>
    <script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>
    <script>
      //Referenced from assignment 1 examples
      function isNonNegInt(q, return_errors = false) {
          errors = []; // assume no errors at first
          if (q == '') q = 0; // handle blank inputs as if they are 0
          if (Number(q) != q) errors.push('<font color="red">Not a number!</font>'); // Check if string is a number value
          else if (q < 0) errors.push('<font color="red">Negative value!</font>'); // Check if it is non-negative
          else if (parseInt(q) != q) errors.push('<font color="red">Not an integer!</font>'); // Check that it is an integer
          return return_errors ? errors : (errors.length == 0);
      }
      function checkQuantityTextbox(theTextbox) {
          errs = isNonNegInt(theTextbox.value, true);
          if (errs.length == 0) errs = ['You want:'];
          if (theTextbox.value.trim() == '') errs = ['Quantity'];
          document.getElementById(theTextbox.name + '_label').innerHTML = errs.join(", ");
     }
     //Add to session, from the amount in the cart
     function add_to_cart (i) {
      var incart = product_main_display[`quantity${i}`].value; 
      if (isNonNegInt(incart) = true) { 
          sessionStorage['products${i}'] = incart;
          console.log(incart) 
      } 
      
  
  
     }
  
      window.onload = function () {
          let params = (new URL(document.location)).searchParams; // get the query string which has the form data
          // form was submitted so check that quantities are valid then redirect to invoice if ok.
          if (params.has('submitcart')) {
              has_errors = false; // assume quantities are valid from the start
              total_qty = 0; // need to check if something was selected so we will look if the total > 0
              //For every product in the array, write the product number, display its image and name, and list price
              for (i = 0; i < products.length; i++) {
                  if (params.has(`quantity${i}`)) {
                      a_qty = params.get(`quantity${i}`);
                      // make textboxes sticky in case of invalid data
                      product_form[`quantity${i}`].value = a_qty;
                      total_qty += a_qty;
                      if (!isNonNegInt(a_qty)) {
                          has_errors = true; // oops, invalid quantity
                          checkQuantityTextbox(product_form[`quantity${i}`]); // show where the error is
                      }
                  }
              }
              // Now respond to errors or redirect to invoice if all is ok
              if (has_errors == true) {
                  alert("Please enter only valid quantities! Cannot add to cart!");
              } else if (total_qty == 0) { // no quantity selections, just give a general alert
                  alert("Please enter only valid quantities! Cannot add to cart!");
              } 
              
          } 
      }
      function saveProduct(i) { //saves the product to the cart 
            var amountProduct = quantity_form[`quantity_textbox${i}`].value;
            if (isNonNegInt(amountProduct) == true) { //if it has no errrors 
                sessionStorage[`${product}${i}`] = amountProduct; //save this product amount 
                document.getElementById(`cart${i}`).innerHTML = 'Added to Cart!'; //tells them it was added to the cart
            } else {
                document.getElementById(`cart${i}`).innerHTML = 'Not Added to Cart: Please Enter Valid Product Amount'; //tells them it is invalid 
            };
            window.location.reload();
        };
  var cart = sessionStorage.length;
                                    if (cart > 0) {
                                        console.log(
                                            cart
                                        )
                                    };
    </script>
    
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Welcome</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/prettyPhoto.css" rel="stylesheet">
    <link href="css/price-range.css" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
	<link href="css/responsive.css" rel="stylesheet">
	<link href="css/product.css" rel="stylesheet">
	<link href="css/main.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->       
    <link rel="shortcut icon" href="images/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="images/ico/apple-touch-icon-57-precomposed.png">
     <style>
        header{
            text-align: center;
            margin-bottom: 30px;
        }
        form{
    text-align: center;
}
    input[type=submit] {
        font-weight: bold;
        font-size: 20px;
        color:black;
        margin-top: 25px;
    }

   /* styling the navbar */
    .topnav {
      overflow: hidden;
      background-color: #ffb6c1;
    }
    
    .topnav a {
      float: left;
      color: #f2f2f2;
      padding: 14px 16px;
      font-size: 17px;
    }
    /* Changes color on hover*/
    .topnav a:hover {
      background-color: #FF69B4	;
      color: black;
    }
    body {
background-color: #FFF0F5;
    }
    </style>
</head><!--/head-->
<body>
		<div class="header-middle"><!--header-middle-->
			<div class="container">
				<div class="row">
					<div class="col-md-4 clearfix">
						<div class="logo pull-left">
							<a href="index.html"><img src="" alt="" /></a>
						</div>
						<div class="btn-group pull-right clearfix">
							<div class="btn-group">
								<h1>Rianne's Handmade Earrings</h1>
							</div>
							
						
					</div>
				</div>
			</div>
	</header>
    
 <div class="topnav"> 
    <a class="active" href="./index.html">Home</a> 
    <a class="active" href="./all.html">All</a> 
    <a href="./tvmovie.html">TV, Movies and Music</a> 
    <a href="./videogame.html">Video Game</a> 
    <a href="./holidays.html">Holidays</a>
    <a href="./objectfood.html">Objects and Food</a> 
    <script>
        function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i <ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
var username = getCookie('username');
console.log(username);
if (username != ""){
    document.write(`<a href="./logout">Logout ${username}</a>`);
} else {
    document.write(`<a href="./login">Login</a>`);
}
    </script>
    <a href="./cart.html">Cart</a>
        </div>
<body>


    <form name="product_main_display" action="process_cart" method="POST">
      <div class="row">
        <div class="column">
            <main>
                <script>
                    document.write(`<input type="hidden"  name="product_type" value = "${product_type}">`);
                    for (i = 0; i < products[product_type].length; i++) {
                        document.write(`
                                <section class="item">
                                    <img src="${products[product_type][i].image}">
                                    <h2>${products[product_type][i].product}</h2>
                                    <p>$${products[product_type][i].price}</p>
                                        <label id="quantity${i}_label"}">Quantity</label>
                                    <input type="text" placeholder="0" name="quantity${i}" 
                                    onkeyup="checkQuantityTextbox(this);">

                
                                </section>
                            `);
                            if (typeof cart[`quantity${i}`] != 'undefined' ) {
                                product_main_display[`quantity${i}`].value = cart[`quantity${i}`];
                            }
                    }
                </script>
            </main>
        </div></div></div>
    <div>
        <footer>
            <div style="text-align:center">  
          <input type="submit" value="Add to cart" name="submitcart" onclick="addtoCart()">
          </div>
        </footer>
    </form>
</body>
</html> 